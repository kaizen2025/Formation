{% extends 'base.html' %}

{% block title %}Anecoop Formations - Tableau de bord admin{% endblock %}

{% block extra_css %}
<style>
    .stat-card {
        background-color: white;
        border-radius: 8px;
        padding: 1.5rem;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        height: 100%;
        transition: transform 0.3s, box-shadow 0.3s;
    }
    
    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .stat-card .number {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary);
    }
    
    .stat-card .title {
        color: var(--gray);
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    .chart-container {
        height: 300px;
        position: relative;
    }
</style>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Tableau de bord administrateur</h1>
    <div>
        <a href="{{ url_for('admin_logout') }}" class="btn btn-outline-secondary">
            <i class="fas fa-sign-out-alt"></i> Déconnexion
        </a>
    </div>
</div>

<ul class="nav nav-tabs mb-4" id="adminTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab" aria-controls="dashboard" aria-selected="true">
            <i class="fas fa-chart-bar"></i> Tableau de bord
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="bookings-tab" data-bs-toggle="tab" data-bs-target="#bookings" type="button" role="tab" aria-controls="bookings" aria-selected="false">
            <i class="fas fa-calendar-check"></i> Réservations
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="participants-tab" data-bs-toggle="tab" data-bs-target="#participants" type="button" role="tab" aria-controls="participants" aria-selected="false">
            <i class="fas fa-users"></i> Participants
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="waitlist-tab" data-bs-toggle="tab" data-bs-target="#waitlist" type="button" role="tab" aria-controls="waitlist" aria-selected="false">
            <i class="fas fa-user-clock"></i> Liste d'attente
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="logs-tab" data-bs-toggle="tab" data-bs-target="#logs" type="button" role="tab" aria-controls="logs" aria-selected="false">
            <i class="fas fa-history"></i> Historique
        </button>
    </li>
</ul>

<div class="tab-content" id="adminTabsContent">
    <!-- TABLEAU DE BORD -->
    <div class="tab-pane fade show active" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab">
        <div class="row gy-4">
            <div class="col-md-4 col-sm-6">
                <div class="stat-card">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="number">{{ stats.total_bookings }}</div>
                            <div class="title">Réservations</div>
                        </div>
                        <div class="icon">
                            <i class="fas fa-calendar-check fa-2x text-primary opacity-50"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 col-sm-6">
                <div class="stat-card">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="number">{{ stats.total_participants }}</div>
                            <div class="title">Participants</div>
                        </div>
                        <div class="icon">
                            <i class="fas fa-users fa-2x text-success opacity-50"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 col-sm-6">
                <div class="stat-card">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="number">{{ stats.waiting_list_count }}</div>
                            <div class="title">En attente</div>
                        </div>
                        <div class="icon">
                            <i class="fas fa-user-clock fa-2x text-warning opacity-50"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">Réservations par service</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="serviceChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">Réservations par formation</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="formationChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">Réservations par mois</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="monthChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- RÉSERVATIONS -->
    <div class="tab-pane fade" id="bookings" role="tabpanel" aria-labelledby="bookings-tab">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Liste des réservations</h5>
                <div>
                    <button class="btn btn-sm btn-outline-primary" id="refreshBookingsBtn">
                        <i class="fas fa-sync-alt"></i> Actualiser
                    </button>
                    <button class="btn btn-sm btn-outline-success" id="exportBookingsBtn">
                        <i class="fas fa-file-export"></i> Exporter
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="bookingsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Service</th>
                                <th>Formation</th>
                                <th>Date</th>
                                <th>Horaire</th>
                                <th>Participants</th>
                                <th>Statut</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="bookingsTableBody">
                            <!-- Sera rempli dynamiquement -->
                            <tr>
                                <td colspan="8" class="text-center">Chargement des données...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- PARTICIPANTS -->
    <div class="tab-pane fade" id="participants" role="tabpanel" aria-labelledby="participants-tab">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Liste des participants</h5>
                <div>
                    <button class="btn btn-sm btn-outline-primary" id="refreshParticipantsBtn">
                        <i class="fas fa-sync-alt"></i> Actualiser
                    </button>
                    <button class="btn btn-sm btn-outline-success" id="exportParticipantsBtn">
                        <i class="fas fa-file-export"></i> Exporter
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="participantsTable">
                        <thead>
                            <tr>
                                <th>Nom</th>
                                <th>Email</th>
                                <th>Département</th>
                                <th>Service</th>
                                <th>Formation</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="participantsTableBody">
                            <!-- Sera rempli dynamiquement -->
                            <tr>
                                <td colspan="7" class="text-center">Chargement des données...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- LISTE D'ATTENTE -->
    <div class="tab-pane fade" id="waitlist" role="tabpanel" aria-labelledby="waitlist-tab">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Liste d'attente</h5>
                <div>
                    <button class="btn btn-sm btn-outline-primary" id="refreshWaitlistBtn">
                        <i class="fas fa-sync-alt"></i> Actualiser
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="waitlistTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nom</th>
                                <th>Email</th>
                                <th>Service</th>
                                <th>Formation</th>
                                <th>Date</th>
                                <th>Statut</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="waitlistTableBody">
                            <!-- Sera rempli dynamiquement -->
                            <tr>
                                <td colspan="8" class="text-center">Chargement des données...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- HISTORIQUE -->
    <div class="tab-pane fade" id="logs" role="tabpanel" aria-labelledby="logs-tab">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Historique des activités</h5>
                <div>
                    <button class="btn btn-sm btn-outline-primary" id="refreshLogsBtn">
                        <i class="fas fa-sync-alt"></i> Actualiser
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="logsTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Action</th>
                                <th>Utilisateur</th>
                                <th>Détails</th>
                            </tr>
                        </thead>
                        <tbody id="logsTableBody">
                            <!-- Sera rempli dynamiquement -->
                            <tr>
                                <td colspan="4" class="text-center">Chargement des données...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Données pour les graphiques
    const serviceData = {{ stats.bookings_by_service|tojson }};
    const formationData = {{ stats.bookings_by_formation|tojson }};
    const monthData = {{ stats.bookings_by_month|tojson }};

    // Initialiser les graphiques
    initCharts(serviceData, formationData, monthData);

    // Charger les données des tableaux
    loadBookingsTable();
    loadParticipantsTable();
    loadWaitlistTable();
    loadLogsTable();

    // Gestionnaires d'événements pour les boutons de refresh
    document.getElementById('refreshBookingsBtn').addEventListener('click', loadBookingsTable);
    document.getElementById('refreshParticipantsBtn').addEventListener('click', loadParticipantsTable);
    document.getElementById('refreshWaitlistBtn').addEventListener('click', loadWaitlistTable);
    document.getElementById('refreshLogsBtn').addEventListener('click', loadLogsTable);

    // Gestionnaires d'événements pour les boutons d'export
    document.getElementById('exportBookingsBtn').addEventListener('click', function() {
        window.location.href = '/admin/export/bookings';
    });

    document.getElementById('exportParticipantsBtn').addEventListener('click', function() {
        window.location.href = '/admin/export/participants';
    });
});

function initCharts(serviceData, formationData, monthData) {
    // Graphique par service
    const serviceCtx = document.getElementById('serviceChart').getContext('2d');
    new Chart(serviceCtx, {
        type: 'pie',
        data: {
            labels: Object.keys(serviceData).map(key => {
                switch(key) {
                    case 'commerce-1': return 'Commerce (Groupe 1)';
                    case 'commerce-2': return 'Commerce (Groupe 2)';
                    case 'comptabilite': return 'Comptabilité';
                    case 'rh-qualite-marketing': return 'RH/Qualité/Marketing';
                    default: return key;
                }
            }),
            datasets: [{
                data: Object.values(serviceData),
                backgroundColor: ['#2c6ecb', '#4a81d4', '#e67e22', '#2ecc71'],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'right',
                }
            }
        }
    });

    // Graphique par formation
    const formationCtx = document.getElementById('formationChart').getContext('2d');
    new Chart(formationCtx, {
        type: 'bar',
        data: {
            labels: Object.keys(formationData),
            datasets: [{
                label: 'Nombre de réservations',
                data: Object.values(formationData),
                backgroundColor: '#2c6ecb',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        precision: 0
                    }
                }
            }
        }
    });

    // Graphique par mois
    const monthCtx = document.getElementById('monthChart').getContext('2d');

    // Transformer les données par mois
    const months = [
        'Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin',
        'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'
    ];

    const monthLabels = [];
    const monthValues = [];

    for (let i = 1; i <= 12; i++) {
        if (monthData[i]) {
            monthLabels.push(months[i-1]);
            monthValues.push(monthData[i]);
        }
    }

    new Chart(monthCtx, {
        type: 'line',
        data: {
            labels: monthLabels,
            datasets: [{
                label: 'Réservations par mois',
                data: monthValues,
                borderColor: '#2c6ecb',
                backgroundColor: 'rgba(44, 110, 203, 0.1)',
                borderWidth: 2,
                fill: true,
                tension: 0.1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        precision: 0
                    }
                }
            }
        }
    });
}

function loadBookingsTable() {
    const tableBody = document.getElementById('bookingsTableBody');
    tableBody.innerHTML = '<tr><td colspan="8" class="text-center"><div class="spinner-border spinner-border-sm" role="status"></div> Chargement...</td></tr>';

    fetch('/api/bookings')
        .then(response => response.json())
        .then(bookings => {
            if (bookings.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="8" class="text-center">Aucune réservation trouvée</td></tr>';
                return;
            }

            tableBody.innerHTML = '';

            bookings.forEach(booking => {
                const date = new Date(booking.date);
                const formattedDate = `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;

                const hour = booking.hour;
                const minutes = booking.minutes;
                const formattedStart = `${hour.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;

                let endHour = hour + 1;
                let endMinutes = minutes + 30;

                if (endMinutes >= 60) {
                    endHour += 1;
                    endMinutes -= 60;
                }

                const formattedEnd = `${endHour.toString().padStart(2, '0')}:${endMinutes.toString().padStart(2, '0')}`;
                const formattedTime = `${formattedStart} - ${formattedEnd}`;

                // Déterminer le service
                let serviceName = booking.service;
                switch(booking.service) {
                    case 'commerce-1': serviceName = 'Commerce (G1)'; break;
                    case 'commerce-2': serviceName = 'Commerce (G2)'; break;
                    case 'comptabilite': serviceName = 'Comptabilité'; break;
                    case 'rh-qualite-marketing': serviceName = 'RH/Qualité/Marketing'; break;
                }

                // Nombre de participants
                const participantCount = booking.participants ? booking.participants.length : 0;

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${booking.id}</td>
                    <td>${serviceName}</td>
                    <td>${booking.formation_name}</td>
                    <td>${formattedDate}</td>
                    <td>${formattedTime}</td>
                    <td>${participantCount}/12</td>
                    <td><span class="badge bg-success">${booking.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary view-booking" data-id="${booking.id}" title="Voir détails">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-warning edit-booking" data-id="${booking.id}" title="Modifier">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger delete-booking" data-id="${booking.id}" title="Supprimer">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;

                tableBody.appendChild(row);
            });

            // Ajouter les gestionnaires d'événements pour les boutons
            addBookingButtonHandlers();
        })
        .catch(error => {
            console.error('Erreur lors du chargement des réservations:', error);
            tableBody.innerHTML = '<tr><td colspan="8" class="text-center text-danger">Erreur lors du chargement des données</td></tr>';
        });
}

function loadParticipantsTable() {
    const tableBody = document.getElementById('participantsTableBody');
    tableBody.innerHTML = '<tr><td colspan="7" class="text-center"><div class="spinner-border spinner-border-sm" role="status"></div> Chargement...</td></tr>';

    fetch('/api/bookings')
        .then(response => response.json())
        .then(bookings => {
            // Extraire tous les participants
            const participants = [];

            bookings.forEach(booking => {
                if (booking.participants && booking.participants.length > 0) {
                    booking.participants.forEach(participant => {
                        participants.push({
                            name: participant.name,
                            email: participant.email || '-',
                            department: participant.department || '-',
                            service: booking.service,
                            formation_name: booking.formation_name,
                            date: booking.date,
                            booking_id: booking.id
                        });
                    });
                }
            });

            if (participants.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" class="text-center">Aucun participant trouvé</td></tr>';
                return;
            }

            tableBody.innerHTML = '';

            participants.forEach(participant => {
                const date = new Date(participant.date);
                const formattedDate = `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;

                // Déterminer le service
                let serviceName = participant.service;
                switch(participant.service) {
                    case 'commerce-1': serviceName = 'Commerce (G1)'; break;
                    case 'commerce-2': serviceName = 'Commerce (G2)'; break;
                    case 'comptabilite': serviceName = 'Comptabilité'; break;
                    case 'rh-qualite-marketing': serviceName = 'RH/Qualité/Marketing'; break;
                }

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${participant.name}</td>
                    <td>${participant.email}</td>
                    <td>${participant.department}</td>
                    <td>${serviceName}</td>
                    <td>${participant.formation_name}</td>
                    <td>${formattedDate}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" title="Voir réservation" onclick="viewBooking(${participant.booking_id})">
                            <i class="fas fa-calendar-check"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-warning" title="Modifier participant">
                            <i class="fas fa-user-edit"></i>
                        </button>
                    </td>
                `;

                tableBody.appendChild(row);
            });
        })
        .catch(error => {
            console.error('Erreur lors du chargement des participants:', error);
            tableBody.innerHTML = '<tr><td colspan="7" class="text-center text-danger">Erreur lors du chargement des données</td></tr>';
        });
}

function loadWaitlistTable() {
    const tableBody = document.getElementById('waitlistTableBody');
    tableBody.innerHTML = '<tr><td colspan="8" class="text-center"><div class="spinner-border spinner-border-sm" role="status"></div> Chargement...</td></tr>';

    fetch('/api/waitlist')
        .then(response => response.json())
        .then(waitlist => {
            if (waitlist.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="8" class="text-center">Aucune entrée en liste d\'attente</td></tr>';
                return;
            }

            tableBody.innerHTML = '';

            waitlist.forEach(entry => {
                const date = new Date(entry.date);
                const formattedDate = `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;

                let serviceName = entry.service;
                switch(entry.service) {
                    case 'commerce-1': serviceName = 'Commerce (G1)'; break;
                    case 'commerce-2': serviceName = 'Commerce (G2)'; break;
                    case 'comptabilite': serviceName = 'Comptabilité'; break;
                    case 'rh-qualite-marketing': serviceName = 'RH/Qualité/Marketing'; break;
                }

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${entry.id}</td>
                    <td>${entry.contact}</td>
                    <td>${entry.email}</td>
                    <td>${serviceName}</td>
                    <td>${entry.formation_name}</td>
                    <td>${formattedDate}</td>
                    <td><span class="badge bg-warning">${entry.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary view-waitlist" data-id="${entry.id}" title="Voir détails">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger delete-waitlist" data-id="${entry.id}" title="Supprimer">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;

                tableBody.appendChild(row);
            });
        })
        .catch(error => {
            console.error('Erreur lors du chargement de la liste d\'attente:', error);
            tableBody.innerHTML = '<tr><td colspan="8" class="text-center text-danger">Erreur lors du chargement des données</td></tr>';
        });
}

function loadLogsTable() {
    const tableBody = document.getElementById('logsTableBody');
    tableBody.innerHTML = '<tr><td colspan="4" class="text-center"><div class="spinner-border spinner-border-sm" role="status"></div> Chargement...</td></tr>';

    fetch('/api/logs')
        .then(response => response.json())
        .then(logs => {
            if (logs.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="4" class="text-center">Aucun log trouvé</td></tr>';
                return;
            }

            tableBody.innerHTML = '';

            logs.forEach(log => {
                const date = new Date(log.timestamp);
                const formattedDate = `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;

                const userInfo = log.user_info ? (log.user_info.email || '-') : '-';
                const details = log.details ? JSON.stringify(log.details) : '-';

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formattedDate}</td>
                    <td>${log.action}</td>
                    <td>${userInfo}</td>
                    <td>${details}</td>
                `;

                tableBody.appendChild(row);
            });
        })
        .catch(error => {
            console.error('Erreur lors du chargement des logs:', error);
            tableBody.innerHTML = '<tr><td colspan="4" class="text-center text-danger">Erreur lors du chargement des données</td></tr>';
        });
}

function addBookingButtonHandlers() {
    document.querySelectorAll('.view-booking').forEach(button => {
        button.addEventListener('click', function() {
            const id = this.getAttribute('data-id');
            window.location.href = `/admin/booking/${id}`;
        });
    });

    document.querySelectorAll('.edit-booking').forEach(button => {
        button.addEventListener('click', function() {
            const id = this.getAttribute('data-id');
            alert('Modification de la réservation ID: ' + id + ' (fonctionnalité à implémenter)');
        });
    });

    document.querySelectorAll('.delete-booking').forEach(button => {
        button.addEventListener('click', function() {
            const id = this.getAttribute('data-id');
            if (confirm('Voulez-vous vraiment supprimer cette réservation ?')) {
                fetch(`/api/booking/${id}`, { method: 'DELETE' })
                    .then(response => {
                        if (response.ok) {
                            loadBookingsTable();
                        } else {
                            alert('Erreur lors de la suppression');
                        }
                    });
            }
        });
    });

    document.querySelectorAll('.view-waitlist').forEach(button => {
        button.addEventListener('click', function() {
            const id = this.getAttribute('data-id');
            alert('Voir détails de l\'entrée ID: ' + id + ' (fonctionnalité à implémenter)');
        });
    });

    document.querySelectorAll('.delete-waitlist').forEach(button => {
        button.addEventListener('click', function() {
            const id = this.getAttribute('data-id');
            if (confirm('Voulez-vous vraiment supprimer cette entrée de la liste d\'attente ?')) {
                // Note : Cette API n'existe pas encore, à implémenter si nécessaire
                alert('Suppression de l\'entrée ID: ' + id + ' (fonctionnalité à implémenter)');
            }
        });
    });
}

function viewBooking(id) {
    window.location.href = `/admin/booking/${id}`;
}
</script>
{% endblock %}